<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://www.fergusfettes.com/css/frameworks.css" />
    <link crossorigin="anonymous" media="all" rel="stylesheet" href="https://www.fergusfettes.com/css/github.css" />
    
    <link crossorigin="anonymous" media="(prefers-color-scheme: dark)" rel="stylesheet"
        href="https://www.fergusfettes.com/css/dark.css" />
    
    <meta name="viewport" content="width=device-width">
    <meta name="description"
        content="I&amp;rsquo;m going to mirror my blog in Hyperspace (aka the backend of the Beaker browser, if you don&amp;rsquo;t know about it I suggest you check that out first).
To do this, I&amp;rsquo;m going to try setting up my free micro instance1 in the gcloud as a hyperdrive host." />
    <meta name="keywords"
        content="" />
    <meta name="robots" content="noodp" />
    <link rel="canonical" href="https://www.fergusfettes.com/posts/distributed-mirrors/" />

    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Mirroring in the Hyperspace (and the IPFS?) - Website of Fergus Fettes" />
    <meta name="twitter:description"
        content="I&amp;rsquo;m going to mirror my blog in Hyperspace (aka the backend of the Beaker browser, if you don&amp;rsquo;t know about it I suggest you check that out first).
To do this, I&amp;rsquo;m going to try setting up my free micro instance1 in the gcloud as a hyperdrive host." />
    <meta name="twitter:site" content="https://www.fergusfettes.com" />
    <meta name="twitter:creator" content="" />
    <meta name="twitter:image"
        content="https://www.fergusfettes.com">

    
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Mirroring in the Hyperspace (and the IPFS?) - Website of Fergus Fettes">
    <meta property="og:description"
        content="I&amp;rsquo;m going to mirror my blog in Hyperspace (aka the backend of the Beaker browser, if you don&amp;rsquo;t know about it I suggest you check that out first).
To do this, I&amp;rsquo;m going to try setting up my free micro instance1 in the gcloud as a hyperdrive host." />
    <meta property="og:url" content="https://www.fergusfettes.com/posts/distributed-mirrors/" />
    <meta property="og:site_name" content="Mirroring in the Hyperspace (and the IPFS?)" />
    <meta property="og:image"
        content="https://www.fergusfettes.com">
    <meta property="og:image:width" content="2048">
    <meta property="og:image:height" content="1024">
    
    <meta property="article:published_time" content="2020-12-29 18:03:06 &#43;0100 CET" />
    

    
    

    
    

    <title>Mirroring in the Hyperspace (and the IPFS?) - Website of Fergus Fettes</title>

    <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://www.fergusfettes.com/images/favicon.ico">
    <meta name="theme-color" content="#1e2327">

    
    
    
    
</head>

<body class="env-production emoji-size-boost page-responsive page-profile">
  <div class="position-relative js-header-wrapper ">
    <span class="Progress progress-pjax-loader position-fixed width-full js-pjax-loader-bar">
        <span class="progress-pjax-loader-bar top-0 left-0" style="width: 0%;"></span>
    </span>
    <header class="Header py-lg-0 js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">
        <div class="Header-item d-none d-lg-flex">
            <a class="Header-link" href="https://www.fergusfettes.com" aria-label="Homepage"
                data-ga-click="Header, go to dashboard, icon:logo">
                <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
                    width="32" aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
            </a>
        </div>
        <div
            class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
            <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to"
                role="combobox" aria-owns="jump-to-results" aria-label="Search or jump to" aria-haspopup="listbox"
                aria-expanded="false">
                <div class="position-relative">
                </div>
            </div>
        </div>
        <nav class="d-flex" aria-label="Global">
            <a class="js-selected-navigation-item Header-link py-lg-3">&nbsp;</a>
        </nav>
        <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative" style="margin-right: auto;">
            <a class="Header-link" href="https://www.fergusfettes.com" aria-label="Homepage"
                data-ga-click="Header, go to dashboard, icon:logo">
                <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1"
                    width="32" aria-hidden="true">
                    <path fill-rule="evenodd"
                        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z" />
                </svg>
            </a>
        </div>
        <div class="Header-item position-relative mr-0 d-none d-lg-flex">
            <details class="details-overlay details-reset">
                <summary class="Header-link" aria-label="View profile and more"
                    data-ga-click="Header, show menu, icon:avatar">
                    
                    <img alt="" class="avatar" src="https://www.fergusfettes.com/images/profile.jpg" height="20" width="20">
                    
                </summary>
            </details>
        </div>
    </header>
</div>

<div id="start-of-content" class="show-on-focus"></div>
<div id="js-flash-container">
</div>

  
<div class="application-main " data-commit-hovercards-enabled="">
    <div itemscope="" itemtype="http://schema.org/SoftwareSourceCode" class="">
        <main>
            <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
                <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">
                    <div class="mb-3 d-flex">
                        <h1 class="public css-truncate float-none flex-auto width-fit pl-0">
                            <a class="avatar mr-1" href="https://www.fergusfettes.com/about/">
                                
                                    <img src="https://www.fergusfettes.com/images/profile.jpg" width="26" height="26">
                                
                            </a>
                            <span class="author"><a href="https://www.fergusfettes.com">Fergus Fettes</a></span>
                            <span class="path-divider">/</span>
                            <strong itemprop="name" class="css-truncate-target" style="max-width: 410px"><a
                                    href="https://www.fergusfettes.com/posts/distributed-mirrors/">Mirroring in the Hyperspace (and the IPFS?)</a></strong>

                            <div class="d-block text-small text-gray">
                                Created <time-ago datetime="Tue, 29 Dec 2020 18:03:06 &#43;0100" class="no-wrap">
                                    Mon, 02 Jan 2006 15:04:05 -0700</time-ago>
                                <span class="file-info-divider"></span>
                                Modified <time-ago datetime="Tue, 29 Dec 2020 18:03:06 &#43;0100" class="no-wrap">
                                        Mon, 02 Jan 2006 15:04:05 -0700</time-ago>
                            </div>
                        </h1>
                    </div>
                </div>
            </div>
            <div class="container-lg clearfix new-discussion-timeline experiment-repo-nav  p-responsive">
                <div class="repository-content ">
                    <div class="Box mt-3 position-relative">
                        <div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">
                            <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                                930 Words
                                
                            </div>
                        </div>

                        <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
                            <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><p>I&rsquo;m going to mirror my blog in <a href="https://github.com/hyperspace-org/hyperdrive-service">Hyperspace</a> (aka the backend of the <a href="https://beakerbrowser.com/">Beaker browser</a>, if you don&rsquo;t know about it I suggest you check that out first).</p>
<p>To do this, I&rsquo;m going to try setting up my free micro instance<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> in the gcloud as a hyperdrive host.</p>
<h1 id="hyperdrive-host">Hyperdrive Host</h1>
<p>I&rsquo;ve had trouble doing big installs on a micro instance before. For reference, here are the specs of a micro instance:</p>
<table>
<thead>
<tr>
<th>RAM</th>
<th>Cores</th>
<th>Mem</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.6GB</td>
<td>0.2 (aka a shared core!)</td>
<td>32GB</td>
</tr>
</tbody>
</table>
<p>I run my <a href="https://raw.githubusercontent.com/FergusFettes/dotfiles/master/scripts/new_laptop_installation.yaml">ansible script</a> against it, and it dies. I try to install and run a docker image, it dies. It is not made for grand works. Or even minor works.</p>
<p>So in order to get everything nicely installed and prepared I decided to make a &lsquo;<a href="https://raw.githubusercontent.com/FergusFettes/dotfiles/master/scripts/gcloud/small-computer.sh">standard simple computer</a>'. This is a decently-proportioned machine I can run in the cloud for generating snapshots that can be used as the base image for smaller, gentler machines. It does all the installations without crashing.</p>
<p>I also used the opportunity try try out a preemtible instance. This is an instance that google can kill whenever, and is about 3x cheaper than a normal machine. Since I am just running this machine to do little tasks in the cloud, I don&rsquo;t care if it gets killed sometimes. However, I didn&rsquo;t realise that my free cloud credits can&rsquo;t be used for preemtible instances, I only found this out after. This means&ndash; shock horror! I will actually get billed for this usage. Lets see how much.</p>
<table>
<thead>
<tr>
<th>SKU</th>
<th>Service</th>
<th>Usage</th>
<th>Cost</th>
</tr>
</thead>
<tbody>
<tr>
<td>Preemptible E2 Instance Core running in Americas</td>
<td>Compute Engine</td>
<td>1.63 hour</td>
<td>€0.01</td>
</tr>
<tr>
<td>Preemptible E2 Instance Ram running in Americas</td>
<td>Compute Engine</td>
<td>6.5 gibibyte hour</td>
<td>€0.00</td>
</tr>
</tbody>
</table>
<p>Okay not too terrible.</p>
<p>So now I have a snapshot with some basic things installed, I can try running a hperdrive host. Obviously I don&rsquo;t need all my command-line tools and everything to really run it, but its nice to have this snapshot available for future machines. And when I get it all running stably, I can create a minimal snapshot with only the server I want so it runs more smoothly.</p>
<p>To make my hyperdrive, I&rsquo;m just going to open up the Beaker browser and see how it is these days, it&rsquo;s been almost six months since I used it and it&rsquo;s developing rapidly. Oh! They have a &lsquo;create hyperdrive from git repo&rsquo; button now! This gets better and better.</p>
<p>So I&rsquo;m now hosted on the Beaker network. <a href="hyper://cb8bb0fdb843f78267df2dce7c4dd3cb4fd89a9b16c4454912691a73e5d1c737/">URL</a>.</p>
<p>Okay so it seems the way Hugo generates sites, based on the CNAME that I supplied, means that all the links from the frontpage on beaker go straight to the clearnet version at <a href="http://www.fergusfettes.com">www.fergusfettes.com</a>. This is slightly annoying but I&rsquo;ll not work on it now, since all the rest of the stuff is actually there, it just isn&rsquo;t linked correctly. <a href="hyper://cb8bb0fdb843f78267df2dce7c4dd3cb4fd89a9b16c4454912691a73e5d1c737/posts/distributed-mirrors/">This post</a> on the hyperspace, for example.</p>
<p>Another thing to note, is I would need to host all the images in hyperspace too to be really complete. However, as it is now, it is a great demonstration of how nicely the hyper protocol interacts with http.</p>
<p>So now I&rsquo;m restarting my micro instance with the hyperdrive installed. Starting hyperspace (<code>hyperspace start</code>), and hyperdrive (<code>hyperdrive start</code>). Playing around with the hyperdrive cli, I can get info about my local hyperdrvie once I have cd&rsquo;ed into it: <code>cd Hyperdrive; hyperdrive info --root</code>.</p>
<p>Now I&rsquo;ll try mounting the hyperdrive that was created on my laptop by the Beaker browser. I copy the <a href="hyper://cb8bb0fdb843f78267df2dce7c4dd3cb4fd89a9b16c4454912691a73e5d1c737/">URL</a> ID (aka. without the &lsquo;hyper://') and serve it with</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hyperdrive mount cb8bb0fdb843f78267df2dce7c4dd3cb4fd89a9b16c4454912691a73e5d1c737
hyperdrive seed /home/ffettes/Hyperdrive/cb8bb0fdb843f78267df2dce7c4dd3cb4fd89a9b16c4454912691a73e5d1c737
</code></pre></div><p>(after the mount there is handy output telling you what to do next :D).</p>
<p>Having a look around the <a href="https://userlist.beakerbrowser.com/">beaker user list</a>, I found my first attempt at a beaker blog is still being hosted (I&rsquo;m @frgnym)! I feel so touched! Someone out there is still on my website! I&rsquo;ll seed it too:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hyperdrive mount c2b2403c8aa02cfdff740614ffc437cd09f243d98f84ebe0eb37a86eedf677bb
hyperdrive seed /home/ffettes/Hyperdrive/c2b2403c8aa02cfdff740614ffc437cd09f243d98f84ebe0eb37a86eedf677bb
</code></pre></div><p>Okay awesome. I&rsquo;m not only newly mirrored on the hyper network, my old website is still on there. So great. That was incredibly easy. Maybe I&rsquo;ll start using the beaker browser as my primary browser. (I always say that.)</p>
<p>So now my old website is hosted in three places, whoever was hosting it before, my micro instance, and the browser I am currently viewing it from. See the little three in the top right:
<img src="https://storage.googleapis.com/schau-wien-images/fergus/beaker_screenshot.png" alt="First Beaker Blog Attempt"></p>
<p>And now this blog is hosted there too! Excellent. Now lets see how the IPFS fares!</p>
<p>UPDATE: It was obviously <a href="hyper://25c225f019a7f93ec8aa52799a0d428925c1f82f4ad012bcf9f75c3a64052de1">Kicks Condor</a> who was hosting it before, so I&rsquo;m hosting their drive now too.</p>
<p>UPDATE2: So, the micro host wasn&rsquo;t actually working. I ran a couple tests, turns out I used the complete wrong command. I should have used the following:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hyperdrive mount some_random_name c2b2403c8aa02cfdff740614ffc437cd09f243d98f84ebe0eb37a86eedf677bb
hyperdrive seed /home/ffettes/Hyperdrive/some_random_name
</code></pre></div><p>The random name doesn&rsquo;t seen to affect the seeded drive. &lsquo;hyperdrive mount X&rsquo; creates a new drive called x and creates a new key for it, so I had folders named after all my old drives with new keys and no content.</p>
<p>Anyway I fixed all the mounts and now I see the IP of my micro host in the top right under the hosts. In other news, this means that there were three people hosting my old blog before, and now there are 4!</p>
<h1 id="ipfs-host">IPFS Host</h1>
<p>I&rsquo;ve never actually played with IPFS before so this section might take a while to get updated.</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p>With the Google Cloud Platform free developer package, you get a teeny little machine in the cloud for free forever. <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>
</article>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>


  <div class="footer container-lg width-full p-responsive" role="contentinfo">
    <div
        class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
        <ul
            class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
            <li class="mr-3 mr-lg-0"></a></li>
        </ul>

        <a aria-label="Homepage" title="Website of Fergus Fettes" class="footer-octicon d-none d-lg-block mx-lg-4"
            href="https://www.fergusfettes.com">
            <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24"
                aria-hidden="true">
                <path fill-rule="evenodd"
                    d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                </path>
            </svg>
        </a>
        <ul
            class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        </ul>
    </div>
    <div class="d-flex flex-justify-center pb-6">
        <span class="f6 text-gray-light"></span>
    </div>
</div>

<script crossorigin="anonymous"
    type="application/javascript" src="https://www.fergusfettes.com/js/frameworks.js"></script>

<script crossorigin="anonymous"
    type="application/javascript" src="https://www.fergusfettes.com/js/github-bootstrap.js"></script>
<script src="https://www.fergusfettes.com/js/stop.js"></script>
<script src="https://www.fergusfettes.com/js/contributions.js"></script>

</body>

</html>